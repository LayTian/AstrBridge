# 毕业设计（论文）任务书

## 一、题目
面向 AstrBot 的消息接入网关与管理平台（AstrBridge）的设计与实现

## 二、课题背景与意义
随着智能客服、业务自动化与对话式交互需求的普及，企业侧往往需要将多来源（Web、业务系统、Webhook、第三方平台）的消息统一接入到机器人平台，并保证消息投递可靠、链路可观测、可运维、可审计。传统“点对点”接入方式容易导致接口碎片化、权限与合规能力缺失、故障定位困难。

本课题围绕“统一接入 + 可靠投递 + 权限治理 + 可观测运维”展开，设计并实现一个连接 AstrBot 的消息适配层与管理平台，形成可落地的工程化样例，具有较强的实践价值与教学示范意义。

## 三、研究目标
1. 设计一套面向 AstrBot 的统一消息接入架构，支持 WebSocket 与 HTTP 两种接入模式。
2. 实现会话管理、离线队列、幂等投递与同步等待回复等关键能力。
3. 实现管理后台：状态概览、会话管理、接入中心、数据分析、日志与审计、系统设置等功能。
4. 完成基于指标与规则的健康度评分与可视化展示，提升可观测性与可运维性。
5. 输出完整论文与可运行演示系统，提供可复现实验与测试结果。

## 四、主要任务与内容
### 1) 系统需求分析
- 业务场景与角色（管理员/超级管理员/外部接入方）分析
- 功能需求与非功能需求（安全、可靠性、可用性、可维护性）定义

### 2) 总体架构设计
- 模块划分：WS 适配层、HTTP Integrations 接入层、管理鉴权与 RBAC、会话/队列、日志与审计、指标与健康度、管理后台
- 数据流与控制流：外部消息 → Adapter → AstrBot → 回复回传 → 前端会话/HTTP 同步返回

### 3) 核心功能实现
- WebSocket 会话管理（在线/离线、会话列表、离线队列与落盘）
- HTTP 接入接口（events、request-reply、幂等键处理）
- 管理鉴权（Dual-token：Access + Refresh）与权限控制（RBAC）
- 审计日志与实时日志（SSE）
- 指标快照与健康度评分模型（score/level/reasons）

### 4) 前端管理平台实现
- 仪表盘：关键指标概览、系统动态/自检
- 数据分析：趋势图、QPS、延迟分位、队列 Top、健康度说明
- 会话管理：列表、踢人、离线清理等（按权限）
- 设置：AstrBot 连接参数配置（按权限）

### 5) 测试与评价
- 功能测试：鉴权/RBAC/幂等/离线队列/同步等待回复/日志审计
- 性能与稳定性测试：并发接入、QPS、延迟与超时策略评估
- 可用性与可观测性评价：健康度模型有效性、故障场景覆盖度

## 五、技术路线与实现方案
- 后端：Node.js + TypeScript + Express；WebSocket（ws）；指标/健康度模块；审计与日志模块
- 前端：Vue 3 + Element Plus；ECharts 可视化
- 安全：JWT Access Token + httpOnly Refresh Cookie；RBAC；接入密钥（Integration Secret）
- 可观测性：指标快照（JSON）与 Prometheus 风格导出（文本）；健康度评分规则与解释展示

## 六、预期成果
1. 可运行的软件系统（后端服务 + 管理后台 + OpenAPI 文档 + 演示页面）
2. 论文/说明文档：架构设计、关键实现、测试与评估结果
3. 关键接口与数据结构说明（OpenAPI、前后端交互约定）
4. 测试用例与测试报告（含故障注入/场景验证）

## 七、进度安排（建议）
1. 第 1–2 周：需求分析、调研、可行性论证、总体设计
2. 第 3–5 周：后端核心能力实现（会话、接入、鉴权、审计、指标）
3. 第 6–7 周：管理后台实现与联调
4. 第 8 周：测试与性能评估、问题修复与系统完善
5. 第 9–10 周：论文撰写、答辩材料准备、演示脚本完善

## 八、参考资料（建议）
- OpenAPI Specification 3.0
- JWT（RFC 7519）与 Web 安全实践（Cookie、SameSite、CSRF 基础）
- WebSocket 协议与服务端实现实践
- Prometheus 指标与可观测性体系（计数器/直方图/分位数概念）
